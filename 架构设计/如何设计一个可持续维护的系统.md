# **FAANG和BAT等一线大厂喜欢什么样的代码和架构设计？**

## **前言**

本篇文章的起因，源于某次和一个从Google归国的创业公司的CTO的聊天，我们那天聊了很多，尤其关于一个话题聊了较长时间，这个话题用一句话概括就是：如何才能设计一个可持续维护升级的系统？关于这个问题，我俩彼此交流了很多看法，我对此也收获颇丰。笔者曾经也在国内BAT之一的公司工作过，并在多年的职业生涯中，认识和接触了很多从国外FAANG等公司归国的技术人员。通过自己多年在国内一线互联网公司的工作经历，以及和国外明星高科技公司的同伴和朋友的沟通交流，深刻感觉到这些所谓的一线大厂，对他们开发人员所交付的系统的期望和要求是什么样的。所以，今天这篇文章，就是和大家聊聊这个话题。

## **由一个问题引发的思考**

如何才能设计一个可持续维护升级的系统？从这位Google背景的CTO提的这个问题，我们可以管中窥豹一下，一线大厂对于开发人员提交的代码或者架构师设计出来的系统架构的真正关注点在哪里。

是代码写的极具语法trick或用到某个很厉害的语法糖？还是代码很好地利用了运行平台或环境的某个特性显得极具代码功力？亦或是架构设计使用了当下流行的架构风格让人一看就觉得不明觉厉？

上面这几个方面或许很重要，但如果站在公司的角度，或者站在那位CTO提出的问题的角度来看，或许又不是最重要的那几项。因为上面那几点，并没有站在可持续发展的高度来考虑问题。作为公司来说，如果想从一个小公司发展成一个伟大的大公司，想从一个业务线不断孵化出更多元化的业务增长曲线，想从几个人的小团队发展成为一个上万人的大团队，并在此基础上还能够多快好省的完成代码开发和系统上线，那么核心的关注点一定不是上面那几个方面。

简单来说，对公司发展来说真正难的是，随着业务越来越复杂和多元化，随着团队规模不断增长，随着业务发展的越来越复杂，如何能长期多快好省地在既有系统上持续维护升级？

首先澄清一下，持续地在既有系统上进行维护升级，不等同于整个公司就一套系统，这个问题的前提是，按照公司整体业务架构，我们一定得有与之对应的合理的系统边界和不同的系统。在这个前提背景下，这个问题关注的是，对于这个整体架构下的每个单独的系统，我们更希望它是能够长期持续维护升级的。与之相对的是，我们开发出来的很多系统随着业务的发展，逐渐腐化和不堪重负，不得不推倒重建。

系统的推动重建是一件成本和风险极高的事情，从ROI的角度来说，新建的系统首先必须达到所预期的新回报（比如性能、稳定性、新功能开发效率等），同时还得兼容既有系统的功能和数据，因此比从0到1新开发一个系统的成本都要高（因为没负担）。而且业界现在还有一个怪现象，某些架构师或高工动不动就觉得某个系统架构有问题，希望推动重建，也有不少这样的系统被推动重建了一遍甚至多遍，但最终是否带来了实质性的提升却很难说，但因此而晋升的架构师或高工却不少。

所以，因为种种原因，不到万不得已的时候，公司管理层其实都不愿意推倒重建。所以，如何能够在既有系统的基础上长期持续地维护升级，就变得极其重要。

## **问题拆解**

既然这样，那我们来拆解一下这个问题：如何才能设计一个可持续维护升级的系统？

要回答这个问题，我们就需要思考，一个系统要可持续维护升级，它的维护升级成本主要在哪儿，如何才能让这些成本越低越好，而且这个成本并不随着时间的增长而显著增长。

我们知道，一个系统从开发到上线维护再到下线的生命周期里，大部分的时间主要花在写代码、读代码和改代码等事情上，而且读代码和改代码的时间会远远大于第一次写代码的时间，尤其在持续长时间维护的情况下。

因此，我觉得可以从如下几个方面来思考，如何构建一个可长时间持续维护的系统：

- 好读
- 好改
- 好放心

### **好读**

1. **提升代码的可读性（好读）**：代码用来阅读的时间远长于写代码的时间，如何让代码可读性提升？核心是建立标准且大家理解并认可的技术规范，比如代码规范（比如代码结构、变量和方法命名、代码注释等）、开发规范（比如分支策略）+ 必要的文档，尤其是代码可能很难反映出全貌，所以必要的整体架构文档、交互流程文档（时序图）就比较重要了；

### **好改**

2. **提升架构设计的合理性（好改）**：核心是系统具备良好的架构风格和设计模式，比如
    - 符合架构设计的solid原则（单一职责原则、开闭原则
    、里氏克夫替换原则、接口隔离原则、依赖倒置原则）
    - 分层依赖原则，比如合理的引入设计模式和架构模式（典型如分层模式mvc、基于事件的异步架构模式CQRS等），让架构分层、模块划分更清晰合理

### **好放心**

3. **构建完备的自动化测试用例集（好放心）**：比如践行TDD，通过自动化测试用例集，打造一张安全网，保障每次修改的安全性

你觉得，如果要打造一个可持续维护的系统，还需要什么？欢迎探讨

PS：在写完这篇文章不久，正好看到一篇文章讲[《如何写出让同事无法维护的代码？》](https://mp.weixin.qq.com/s/RChlcA9RFgVQwWsnk_9beg)，里面正好从代码规范、文档注释、程序设计和测试等几个方面进行了阐述，正好对应了我列举的几点，挺有意思，大家可以去那篇文章边读边逆向思考一下^-^
